{% extends "base.html" %}

{% block content %}
<h1>AI Trading Feedback Dashboard</h1>
{% include "partials/_config_banner.html" %}

<div class="portfolio-summary">
  <div class="metric-card" id="summarizerVersionCard">
    <h3>ðŸ“Š Summarizer Prompt</h3>
    <p class="value" id="summarizerVersion">--</p>
  </div>
  <div class="metric-card" id="deciderVersionCard">
    <h3>ðŸŽ¯ Decider Prompt</h3>
    <p class="value" id="deciderVersion">--</p>
  </div>
</div>

<div class="portfolio-summary">
  <div class="metric-card">
    <h3>Success Rate (30d)</h3>
    <p class="value" id="successRate">--</p>
  </div>
  <div class="metric-card">
    <h3>Average Profit (30d)</h3>
    <p class="value" id="avgProfit">--</p>
  </div>
  <div class="metric-card">
    <h3>Total Trades (30d)</h3>
    <p class="value" id="tradeCount">--</p>
  </div>
  <div class="metric-card">
    <h3>Feedback Count</h3>
    <p class="value" id="feedbackCount">--</p>
  </div>
</div>

<div class="feedback-section">
  <h2>ðŸ§  Latest Feedback Analysis</h2>
  <div id="latestFeedback"><p>Loading latest feedback...</p></div>
</div>

<div class="feedback-section">
  <h2>ðŸ“‹ Feedback History (Last 10)</h2>
  <div class="feedback-history-container">
    <div id="feedbackHistory"><p>Loading feedback history...</p></div>
  </div>
</div>

<div class="feedback-section">
  <h2>ðŸ“Š Recent Trade Outcomes</h2>
  <div style="overflow-x:auto;">
    <table class="outcomes-table" id="outcomesTable">
      <thead>
        <tr>
          <th class="sortable" data-column="ticker">Ticker</th>
          <th class="sortable" data-column="sell_date">Sell Date</th>
          <th class="sortable" data-column="shares">Shares</th>
          <th class="sortable" data-column="purchase_price">Purchase Price</th>
          <th class="sortable" data-column="sell_price">Sell Price</th>
          <th class="sortable" data-column="net_gain_dollars">Net Gain ($)</th>
          <th class="sortable" data-column="gain_loss_pct">Gain/Loss %</th>
          <th class="sortable" data-column="category">Category</th>
          <th class="sortable" data-column="hold_days">Hold Days</th>
        </tr>
      </thead>
      <tbody id="outcomesBody"><tr><td colspan="9">Loading...</td></tr></tbody>
    </table>
  </div>
</div>

<div class="chart-container">
  <canvas id="performanceChart"></canvas>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script defer src="{{ url_for('static', filename='js/feedback.js') }}"></script>
{% endblock %}
